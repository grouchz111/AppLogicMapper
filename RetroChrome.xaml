<ResourceDictionary
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:shell="clr-namespace:System.Windows.Shell;assembly=PresentationFramework"
    xmlns:i="http://schemas.microsoft.com/xaml/behaviors">

    <LinearGradientBrush x:Key="LunaTitleBrush" StartPoint="0,0" EndPoint="0,1">
        <GradientStop Color="#4A78D6" Offset="0"/>
        <GradientStop Color="#2B5FB0" Offset="1"/>
    </LinearGradientBrush>

    <Style x:Key="RetroWindowButtonStyle" TargetType="Button">
        <Setter Property="Width" Value="30"/>
        <Setter Property="Height" Value="20"/>
        <Setter Property="Margin" Value="2,3,2,3"/>
        <Setter Property="Background" Value="#D4D0C8"/>
        <Setter Property="BorderBrush" Value="#000000"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="FontFamily" Value="Tahoma"/>
        <Setter Property="FontSize" Value="11"/>
        <Setter Property="Foreground" Value="#000000"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Button">
                    <Border x:Name="bd"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            Background="{TemplateBinding Background}">
                        <ContentPresenter HorizontalAlignment="Center"
                                          VerticalAlignment="Center"/>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="bd" Property="Background" Value="#EDE9E2"/>
                        </Trigger>
                        <Trigger Property="IsPressed" Value="True">
                            <Setter TargetName="bd" Property="Background" Value="#C8C4BE"/>
                            <Setter TargetName="bd" Property="RenderTransform">
                                <Setter.Value>
                                    <TranslateTransform X="0" Y="1"/>
                                </Setter.Value>
                            </Setter>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="RetroCloseButtonStyle"
           BasedOn="{StaticResource RetroWindowButtonStyle}"
           TargetType="Button">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Button">
                    <Border x:Name="bd"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            Background="{TemplateBinding Background}">
                        <ContentPresenter HorizontalAlignment="Center"
                                          VerticalAlignment="Center"/>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="bd" Property="Background" Value="#E81123"/>
                            <Setter Property="Foreground" Value="#FFFFFF"/>
                        </Trigger>
                        <Trigger Property="IsPressed" Value="True">
                            <Setter TargetName="bd" Property="Background" Value="#B20B17"/>
                            <Setter TargetName="bd" Property="RenderTransform">
                                <Setter.Value>
                                    <TranslateTransform X="0" Y="1"/>
                                </Setter.Value>
                            </Setter>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="RetroChrome" TargetType="Window">
        <Setter Property="WindowStyle" Value="None"/>
        <Setter Property="ResizeMode" Value="CanResize"/>
        <Setter Property="Background" Value="#E0E0E0"/>
        <Setter Property="shell:WindowChrome.WindowChrome">
            <Setter.Value>
                <shell:WindowChrome
                    CaptionHeight="28"
                    ResizeBorderThickness="5"
                    GlassFrameThickness="0"
                    CornerRadius="0"
                    UseAeroCaptionButtons="False"/>
            </Setter.Value>
        </Setter>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Window">
                    <Border BorderThickness="2"
                            BorderBrush="#000000"
                            Background="{TemplateBinding Background}">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="28"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <Border Grid.Row="0"
                                    Background="{StaticResource LunaTitleBrush}"
                                    BorderThickness="0,0,0,2"
                                    BorderBrush="#2A2A2A">
                                <Grid shell:WindowChrome.IsHitTestVisibleInChrome="True">
                                    <i:Interaction.Triggers>
                                        <i:EventTrigger EventName="MouseLeftButtonDown">
                                            <i:CallMethodAction TargetObject="{Binding RelativeSource={RelativeSource TemplatedParent}}"
                                                                MethodName="DragMove"/>
                                        </i:EventTrigger>
                                    </i:Interaction.Triggers>

                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>

                                    <StackPanel Orientation="Horizontal"
                                                VerticalAlignment="Center"
                                                Grid.Column="0"
                                                Margin="6,0">
                                        <Image Width="16"
                                               Height="16"
                                               Source="{Binding Icon, RelativeSource={RelativeSource TemplatedParent}}"/>
                                        <TextBlock Text="{TemplateBinding Title}"
                                                   VerticalAlignment="Center"
                                                   Margin="6,0,0,0"
                                                   Foreground="White"
                                                   FontFamily="Tahoma"
                                                   FontWeight="Bold"/>
                                    </StackPanel>

                                    <StackPanel Grid.Column="2"
                                                Orientation="Horizontal"
                                                VerticalAlignment="Center"
                                                Margin="4,0,6,0">

                                        <Button Style="{StaticResource RetroWindowButtonStyle}"
                                                shell:WindowChrome.IsHitTestVisibleInChrome="True">
                                            <i:Interaction.Triggers>
                                                <i:EventTrigger EventName="Click">
                                                    <i:ChangePropertyAction TargetObject="{Binding RelativeSource={RelativeSource AncestorType=Window}}"
                                                                            PropertyName="WindowState"
                                                                            Value="Minimized"/>
                                                </i:EventTrigger>
                                            </i:Interaction.Triggers>
                                            <TextBlock Text="_" FontWeight="Bold" Margin="0,-2,0,0"/>
                                        </Button>

                                        <Button Style="{StaticResource RetroWindowButtonStyle}"
                                                shell:WindowChrome.IsHitTestVisibleInChrome="True">
                                            <Grid Width="12" Height="12">
                                                <Grid>
                                                    <Grid.Style>
                                                        <Style TargetType="Grid">
                                                            <Setter Property="Visibility" Value="Visible"/>
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding WindowState, RelativeSource={RelativeSource AncestorType=Window}}" Value="Maximized">
                                                                    <Setter Property="Visibility" Value="Collapsed"/>
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </Grid.Style>
                                                    <Rectangle Stroke="#000000" StrokeThickness="1" Fill="#D4D0C8"/>
                                                    <i:Interaction.Triggers>
                                                        <i:EventTrigger EventName="Click">
                                                            <i:ChangePropertyAction TargetObject="{Binding RelativeSource={RelativeSource AncestorType=Window}}"
                                                                                    PropertyName="WindowState"
                                                                                    Value="Maximized"/>
                                                        </i:EventTrigger>
                                                    </i:Interaction.Triggers>
                                                </Grid>

                                                <Grid>
                                                    <Grid.Style>
                                                        <Style TargetType="Grid">
                                                            <Setter Property="Visibility" Value="Collapsed"/>
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding WindowState, RelativeSource={RelativeSource AncestorType=Window}}" Value="Maximized">
                                                                    <Setter Property="Visibility" Value="Visible"/>
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </Grid.Style>
                                                    <Rectangle Stroke="#000000" StrokeThickness="1" Fill="#D4D0C8" Margin="0,0,4,4"/>
                                                    <Rectangle Stroke="#000000" StrokeThickness="1" Fill="#D4D0C8" Margin="4,4,0,0"/>
                                                    <i:Interaction.Triggers>
                                                        <i:EventTrigger EventName="Click">
                                                            <i:ChangePropertyAction TargetObject="{Binding RelativeSource={RelativeSource AncestorType=Window}}"
                                                                                    PropertyName="WindowState"
                                                                                    Value="Normal"/>
                                                        </i:EventTrigger>
                                                    </i:Interaction.Triggers>
                                                </Grid>
                                            </Grid>
                                        </Button>

                                        <Button Style="{StaticResource RetroCloseButtonStyle}"
                                                shell:WindowChrome.IsHitTestVisibleInChrome="True">
                                            <i:Interaction.Triggers>
                                                <i:EventTrigger EventName="Click">
                                                    <i:CallMethodAction TargetObject="{Binding RelativeSource={RelativeSource AncestorType=Window}}"
                                                                        MethodName="Close"/>
                                                </i:EventTrigger>
                                            </i:Interaction.Triggers>
                                            <TextBlock Text="X" FontWeight="Bold"/>
                                        </Button>
                                    </StackPanel>
                                </Grid>
                            </Border>

                            <Border Grid.Row="1"
                                    Margin="4"
                                    Background="#dedbcc"
                                    BorderThickness="2"
                                    BorderBrush="#C0C0C0">
                                <ContentPresenter Margin="6"/>
                            </Border>
                        </Grid>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
</ResourceDictionary>